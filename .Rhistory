install.packages("tidyverse")
?principal
??principal
install.packages("RSiena", "sna", "network", "igraph", "xtable")
install.packages("RSiena")
install.packages("sna")
install.packages("igraph")
#Practicing R Skills from Codecademy Learn R Course
#Data pulled from https://www.divvybikes.com/system-data
#load libraries
#library(dplyr) - part of tidyverse
#library(tidyr) - part of tidyverse
#library(lubridate) - part of tidyverse
library(tidyverse)
library(ggmap)
#Read csv for 2020 Q1 into df
trips_2020Q1 <- read.csv('Divvy_Trips_2020_Q1.csv')
#inspect trips_2020Q1
head(trips_2020Q1)
#summarize trips_2020Q1
summary(trips_2020Q1)
#DATA CLEANING
#create df 'times' to work with only start and end times & inspect
times <- trips_2020Q1 %>% select(ride_id, started_at, ended_at)
head(times)
#separate started_at and ended_at columns into date and time
times <- times %>% separate(started_at,
c('started_at_date', 'started_at_time'), sep = ' ') %>%
separate(ended_at, c('ended_at_date', 'ended_at_time'), sep = ' ')
#create started_at_seconds and ended_at_seconds
times <- times %>% mutate(started_at_seconds = as.numeric(as.period(hms(started_at_time), unit = 'sec')),
ended_at_seconds = as.numeric(as.period(hms(ended_at_time), unit = 'sec')) )
#add elapsed time column
times <- times %>% mutate(elapsed_time = ended_at_seconds - started_at_seconds)
#merge trips_2020Q1 and times
trips_2020Q1 <- merge(trips_2020Q1, times, all = TRUE)
remove(times)
#filter out rides with elapsed time less than 2 minutes, assuming these are mistakes
#filters from 426887 to 413499. removes 13388 instances
trips_2020Q1 <- trips_2020Q1 %>% filter(elapsed_time > 120)
#create df to work with ride_id, started_at_date
started_at_date_split <- trips_2020Q1 %>% select(ride_id, started_at_date) %>%
separate(started_at_date, into = c('trip_year', 'trip_month', 'trip_date'))
trips_2020Q1 <- merge(trips_2020Q1, started_at_date_split, all = TRUE)
remove(started_at_date_split)
#make data subset of 100 trips
trips_subset <- sample_n(trips_2020Q1, 100)
#DATA VISUALIZATION
#set API key
ggmap::register_google(key = "AIzaSyCi5YJYKt5yX-wUFTrUgMnVSsN-pbAEMCA")
#create chicago map
chicago_map <- get_map(location = 'Chicago', source = 'google', maptype = 'roadmap', crop = FALSE, zoom = 12)
#scatter plot of trip start stations and end stations overlaid on Chicago map
#connect start and end stations to represent trip
trip_plot <- ggmap(chicago_map) +
geom_point(aes(x = start_lng, y = start_lat), data = trips_subset, alpha = .5, color = 'blue',
size = 2) +
geom_point(aes(x=end_lng, y = end_lat), data = trips_subset, alpha = .5, color = 'darkgreen', size = 2) +
geom_segment(aes(x=start_lng, y = start_lat, xend = end_lng, yend = end_lat), data = trips_subset)
trip_plot
#bar chart with count of rides in each month
month_ridership <- trips_2020Q1 %>%
ggplot(aes(trip_month)) + geom_bar(fill = 'darkgreen')
month_ridership
#bar chart median trip duration in minutes by month - compare to 2019 Q1
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
# Now go through the same process for contact referrals
# haven't pulled all the questions from CHIMS here because there are quite
# a lot of questions that aren't getting asked at present in Network Canvas -
# i think Howard Brown will guide whether there are more sections that should be filled
# in or not
contact_referralqs <- c("Contact's referral basis","Name or alias","Contact's first name",
"Contact's last name",
"Is this person the spouse of the original patient?",
"Person's age (years)","Gender","Pregnant","Number of weeks pregnant",
"Venue where OP met/had sex with this person",
"Was this partner met through the internet?",
"<b>Locating Information</b>",
"Phone number","Address",
"<b>Physical Attributes</b>",
"Height","Weight","Visible identifiers",
"Hair color","Race",
"Exposure date (first)","Exposure date (last)",
"Exposure frequency - number")
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
# recode a bunch of variables that were true/false as TRUE/FALSE to make them easiser to manipulate
person_attr <- person_attr %>%
dplyr::mutate_at(vars("sex_partner","race_white","race_black","race_asian","race_hisp",
"gender_cis_male","gender_cis_female","gender_trans_male",
"gender_trans_female","pregnant_yes","pregnant_no","partner_type_regular",
"partner_type_fwb","partner_type_anon","venue_met_internet","venue_met_bar",
"venue_met_bath","condoms_yes","condoms_sometimes","condoms_no","benefit_from_test",
"bar_specific_1","bar_specific_2","bar_specific_3","bar_specific_4",
"bar_specific_5","bar_specific_6","bar_specific_7","internet_specific_1",
"internet_specific_2","internet_specific_3","internet_specific_4",
"internet_specific_5","internet_specific_6","internet_specific_7",
"HIV_positive","partner_sex_role_bottom","partner_sex_role_top",
"partner_sex_role_vers","partner_sex_type_anal",
"partner_sex_type_oral","partner_sex_type_vaginal",
"partner_type_spouse"),
~recode(., `false`= FALSE, `true` = TRUE, .default = NA))
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
druguse12mind <- c(egodat$drug_use,egodat$alcohol_use,
egodat$drug_specific_crack,egodat$drug_specific_cocaine,
egodat$drug_specific_heroin,egodat$drug_specific_meth,
egodat$drug_specific_nitrate,egodat$drug_specific_erectile_dysfunciton,
egodat$drug_specific_marijuana,egodat$drug_specific_other,
egodat$drug_other,egodat$injection_drug_use,"",egodat$drug_use_freq)
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
library(shiny); runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
venue_attr <- venue_attr %>%
mutate(
#recode venue_met, venue_sex, and venue_drugs to their names to be pasted together
met <- ifelse(venue_met=="true", "Met", ""),
sex <- ifelse(venue_sex=="true", "Sex", ""),
drugs <- ifelse(venue_drugs=="true", "Drug/needle-sharing", ""),
)
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
venue_attr <- venue_attr %>%
mutate(
#recode venue_met, venue_sex, and venue_drugs to their names to be pasted together
met <- ifelse(venue_met=="true", "Met", ""),
sex <- ifelse(venue_sex=="true", "Sex", ""),
drugs <- ifelse(venue_drugs=="true", "Drug/needle-sharing", ""),
#other_venue is venue name if type is missing. if type is present, other_venue is left blank
other_venue = venue_attr$venue
)
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
runApp('Documents/GitHub/R34-RShiny/r34-app.R')
